#### 18.7.6.2 减少缓存大小

XCom 消息缓存大小的最小设置在 MySQL 8.0.20 之前为 1 GB。从 MySQL 8.0.21 开始，最小设置为 134217728 字节（128 MB），这使得在可用内存受限的主机上部署成为可能。如果主机位于不稳定的网络上，不建议将 `group_replication_message_cache_size` 设置得非常低，因为较小的消息缓存使组成员在短暂失去连接后重新连接变得更加困难。

如果重新连接的成员无法从 XCom 消息缓存中检索到所需的所有消息，该成员必须离开组并重新加入，以便通过分布式恢复从另一个成员的二进制日志中检索缺失的事务。从 MySQL 8.0.21 开始，一个离开组的成员默认会进行三次自动重新加入尝试，因此重新加入组的过程仍然可以在无操作员干预的情况下进行。然而，使用分布式恢复重新加入比从 XCom 消息缓存检索消息是一个更长且更复杂的过程，因此成员恢复正常运行的时间更长，且可能影响组的性能。在稳定的网络上，最小化成员短暂失去连接的频率和持续时间，也应该最小化这种情况的发生频率，因此组可能能够容忍较小的 XCom 消息缓存大小，而不会对其性能产生显著影响。

如果您考虑减少缓存大小限制，可以使用以下语句查询性能模式表 `memory_summary_global_by_event_name`：

```sql
SELECT * FROM performance_schema.memory_summary_global_by_event_name
  WHERE EVENT_NAME LIKE 'memory/group_rpl/GCS_XCom::xcom_cache';
```

这将返回消息缓存的内存使用统计，包括当前缓存条目数量和缓存的当前大小。如果您减少缓存大小限制，XCom 会移除已决定并传递的最旧条目，直到当前大小低于限制。在此移除过程进行时，XCom 可能暂时超过缓存大小限制。