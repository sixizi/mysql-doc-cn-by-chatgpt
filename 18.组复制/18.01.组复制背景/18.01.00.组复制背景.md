### 18.1 组复制背景
18.1.1 复制技术

18.1.2 组复制用例

18.1.3 多主和单主模式

18.1.4 组复制服务

18.1.5 组复制插件架构

本节提供了关于MySQL组复制的背景信息。

创建容错系统的最常见方法是使组件具有冗余性，换句话说，组件可以被移除，系统应该继续按预期运行。这为这些系统带来了一系列挑战，将系统的复杂性提升到了一个全新的水平。具体来说，复制数据库必须处理维护和管理多个服务器而不是一个服务器的事实。此外，由于服务器协同工作以创建组，因此必须处理其他经典的分布式系统问题，例如网络分区或脑裂情况。

因此，最终的挑战是将数据库逻辑和数据复制逻辑与有多个服务器以一致且简单的方式协调的逻辑融合在一起。换句话说，就是让多个服务器在系统经历的每一个变化上达成对系统状态和数据的一致认同。这可以概括为使服务器在每个数据库状态转换上达成一致，以便它们都像一个单一数据库那样进展，或者它们最终收敛到相同的状态。这意味着它们需要作为一个（分布式）状态机运行。

MySQL组复制提供了具有服务器之间强协调的分布式状态机复制。当服务器是同一组的一部分时，它们会自动协调。该组可以在单主模式下运行，通过自动主服务器选举，一次只有一个服务器接受更新。或者，对于更高级的用户，该组可以部署在多主模式下，所有服务器都可以接受更新，即使这些更新是同时发出的。这种能力是以应用程序必须绕过此类部署所施加的限制为代价的。

有一个内置的组成员服务，它可以随时为所有服务器维护组视图的一致性和可用性。服务器可以离开和加入组，视图会相应地更新。有时，服务器可能会意外离开组，在这种情况下，故障检测机制会检测到并通知组视图已更改。这一切都是自动进行的。

要使事务提交，组的大多数成员必须就给定事务在全局事务序列中的顺序达成一致。每个服务器单独决定提交或中止事务，但所有服务器做出相同的决定。如果发生网络分区，导致成员无法达成一致，那么系统不会进展，直到这个问题得到解决。因此，还有一个内置的、自动的、防止脑裂的保护机制。

所有这些都由提供的组通信系统（GCS）协议提供支持。这些协议提供了故障检测机制、组成员服务和安全且完全有序的消息传递。所有这些属性都是创建确保数据在服务器组中一致复制的系统的关键。在这项技术的核心是Paxos算法的实现。它作为组通信引擎。