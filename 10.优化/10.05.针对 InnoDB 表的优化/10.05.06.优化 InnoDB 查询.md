### 10.5.6 优化 InnoDB 查询

要为 InnoDB 表优化查询，请为每个表创建一组适当的索引。详见第 10.3.1 节，“MySQL 如何使用索引”。遵循以下 InnoDB 索引的指南：

- 由于每个 InnoDB 表都有一个主键（无论您是否指定），请为每个表指定一组主键列，这些列用于最重要和时间最关键的查询。

- 避免过多或过长的主键列，因为这些列的值会在每个二级索引中重复。当索引包含不必要的数据时，读取这些数据的 I/O 和缓存它的内存会降低服务器的性能和可扩展性。

- 避免为每个列创建单独的二级索引，因为每个查询只能使用一个索引。对于很少被测试的列或仅有少数不同值的列上的索引，对任何查询可能都没有帮助。如果您对同一个表有许多查询，测试不同列的组合，尝试创建少量的连接索引，而不是大量的单列索引。如果一个索引包含了结果集所需的所有列（称为覆盖索引），查询可能完全不需要读取表数据。

- 如果索引列不能包含任何 `NULL` 值，在创建表时将其声明为 `NOT NULL`。当优化器知道每个列是否包含 `NULL` 值时，可以更好地确定哪个索引对查询最有效。

- 您可以使用第 10.5.3 节，“`优化 InnoDB 只读事务`”中的技术来优化 InnoDB 表的单查询事务。