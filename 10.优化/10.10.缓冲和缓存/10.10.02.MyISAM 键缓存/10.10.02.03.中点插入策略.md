#### 10.10.2.3 中点插入策略

默认情况下，键缓存管理系统使用简单的 LRU（最近最少使用）策略选择要驱逐的键缓存块，但它也支持一种更复杂的方法，称为中点插入策略。

在使用中点插入策略时，LRU 链分为两部分：热子列表和温子列表。两个部分之间的分界点不是固定的，但键缓存管理系统会确保温部分不“太短”，始终至少包含 `key_cache_division_limit` 百分比的键缓存块。`key_cache_division_limit` 是结构化键缓存变量的一个组成部分，因此其值是可以为每个缓存单独设置的参数。

当一个索引块从表中读取到键缓存时，它被放置在温子列表的末尾。经过一定次数的命中（块的访问），它被提升到热子列表。目前，提升一个块所需的命中次数（3 次）对于所有索引块都是相同的。

提升到热子列表的块被放置在列表的末尾。然后该块在此子列表中循环。如果该块在热子列表的开头停留的时间足够长，它将被降级到温子列表。此时间由键缓存的 `key_cache_age_threshold` 组件的值决定。

阈值规定，对于包含 N 个块的键缓存，在最后 N * `key_cache_age_threshold` / 100 次命中中未被访问的热子列表开头的块将被移动到温子列表的开头。然后它将成为驱逐的第一个候选者，因为替换的块总是从温子列表的开头选取。

中点插入策略使您能够始终将更有价值的块保留在缓存中。如果您更喜欢使用普通的 LRU 策略，请将 `key_cache_division_limit` 值保持为默认的 100。

中点插入策略有助于在执行需要索引扫描的查询时提高性能，因为该查询会有效地将所有对应于有价值的高级 B 树节点的索引块推出缓存。为了避免这种情况，您必须使用 `key_cache_division_limit` 设置为远小于 100 的中点插入策略。这样，在索引扫描操作期间，宝贵的频繁命中的节点将保留在热子列表中。