# 10.2.1.23 避免全表扫描

当 MySQL 使用全表扫描来解析查询时，`EXPLAIN`的输出会在`type`列中显示`ALL`。通常在以下条件下会发生这种情况：

- 表太小，执行表扫描比使用键查找更快。这在包含少于10行且行长度较短的表中很常见。
- `ON`或`WHERE`子句中没有可用的限制条件用于索引列。
- 你将索引列与常量值进行比较，MySQL 已计算（基于索引树）常量覆盖了表的很大一部分，表扫描会更快。参见 [10.2.1.1 节，`WHERE`子句优化](#)。
- 你通过另一列使用低基数（很多行匹配键值）的键。在这种情况下，MySQL 假定使用该键可能需要很多键查找，表扫描会更快。

对于小表，表扫描通常是合适的，性能影响可以忽略不计。对于大表，请尝试以下技术，以避免优化器错误地选择表扫描：

- 使用 `ANALYZE TABLE tbl_name` 更新扫描表的键分布。参见 [15.7.3.1 节，`ANALYZE TABLE` 语句](#)。
- 对扫描表使用 `FORCE INDEX` 告诉 MySQL 相比于使用给定索引，表扫描非常昂贵：
  ```sql
  SELECT * FROM t1, t2 FORCE INDEX (index_for_column)
    WHERE t1.col_name=t2.col_name;

  参见 [10.9.4 节，索引提示](#)。
- 使用 `--max-seeks-for-key=1000` 选项启动 `mysqld` 或使用 `SET max_seeks_for_key=1000` 告诉优化器假定没有键扫描会导致超过 1,000 次键查找。参见 [7.1.8 节，服务器系统变量](#)。

```