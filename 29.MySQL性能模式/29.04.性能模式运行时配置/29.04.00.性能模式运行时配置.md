## 29.4 性能模式运行时配置

- [29.4.1 性能模式事件计时](./29.04.01.性能模式事件计时.md)
- [29.4.2 性能模式事件过滤](./29.04.02.性能模式事件过滤.md)
- [29.4.3 事件预过滤](./29.04.03.事件预过滤.md)
- [29.4.4 基于检测器的预过滤](./29.04.04.基于检测器的预过滤.md)
- [29.4.5 基于对象的预过滤](./29.04.05.基于对象的预过滤.md)
- [29.4.6 基于线程的预过滤](./29.04.06.基于线程的预过滤.md)
- [29.4.7 基于消费者的预过滤](./29.04.07.基于消费者的预过滤.md)
- [29.4.8 消费者配置示例](./29.04.08.消费者配置示例.md)
- [29.4.9 为过滤操作命名检测器或消费者](./29.04.09.为过滤操作命名检测器或消费者.md)
- [29.4.10 确定被检测的内容](./29.04.10.确定被检测的内容.md)

特定的性能模式功能可以在运行时启用，以控制收集哪些类型的事件。

性能模式的 `setup` 表包含关于监控配置的信息：

```sql
mysql> SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES
       WHERE TABLE_SCHEMA = 'performance_schema'
       AND TABLE_NAME LIKE 'setup%';
+-------------------+
| TABLE_NAME        |
+-------------------+
| setup_actors      |
| setup_consumers   |
| setup_instruments |
| setup_objects     |
| setup_threads     |
+-------------------+
```

你可以查看这些表的内容，以获取关于性能模式监控特性的相关信息。如果你拥有 `UPDATE` 权限，还可以通过修改 `setup` 表来更改性能模式的操作，从而影响监控的方式。有关这些表的更多详细信息，请参阅 [第 29.12.2 节，"性能模式设置表"](29.12.2-Performance-Schema-Setup-Tables)。

`setup_instruments` 和 `setup_consumers` 表分别列出了可以收集事件的检测器和实际收集事件信息的消费者类型。其他 `setup` 表允许进一步修改监控配置。[第 29.4.2 节，"性能模式事件过滤"](29.4.2-Performance-Schema-Event-Filtering) 讨论了如何修改这些表以影响事件收集。

如果必须在运行时通过 SQL 语句对性能模式进行配置更改，并且希望这些更改在每次服务器启动时生效，可以将这些语句放入文件中，并通过设置 `init_file` 系统变量来指定该文件以启动服务器。这种策略在你有多个监控配置时也非常有用，例如用于服务器健康状况的常规监控、事件调查、应用行为故障排除等。将每个监控配置的语句放入各自的文件中，并在启动服务器时将适当的文件指定为 `init_file` 的值。