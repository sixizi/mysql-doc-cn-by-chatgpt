#### 19.3.2.1 二进制日志加密的范围

当 MySQL 服务器实例激活二进制日志加密时，加密覆盖范围如下：

- 静态数据：从开始加密的那一刻起，写入二进制日志文件和中继日志文件的数据使用上述两层加密架构进行加密。在您启动加密时已存在于服务器上的现有二进制日志文件和中继日志文件不会被加密。当这些文件不再需要时，您可以清除它们。

- 动态数据：在复制事件流中的数据，在发送给 MySQL 客户端（包括 mysqlbinlog）时进行解密，因此应通过使用连接加密来保护传输中的数据（参见第 8.3 节，“使用加密连接”和第 19.3.1 节，“设置复制以使用加密连接”）。

- 使用中的数据：在事务期间保存在二进制日志事务和语句缓存中的数据以未加密格式存储在存储缓存的内存缓冲区中。如果数据超出内存缓冲区可用空间，将写入磁盘上的临时文件。从 MySQL 8.0.17 开始，当服务器上激活二进制日志加密时，用于保存二进制日志缓存的临时文件使用 AES-CTR（AES 计数器模式）进行流加密。由于这些临时文件是易失的并且与单一进程绑定，它们使用单层加密，使用仅存在于内存中并且从未存储在磁盘或密钥环上的随机生成的文件密码和初始化向量进行加密。在每个事务提交后，二进制日志缓存会重置：清空内存缓冲区，截断用于保存二进制日志缓存的任何临时文件，并为下一个事务随机生成新的文件密码和初始化向量。当服务器在正常关机或意外停机后重启时，也会进行这种重置。

> 注意
> 如果在设置了 `binlog_format=STATEMENT` 时使用 `LOAD DATA`（不推荐使用，因为该语句被认为对基于语句的复制是不安全的），则会在副本上创建包含数据的临时文件，这些临时文件在服务器上激活二进制日志加密时不会被加密。改用基于行或混合的二进制日志格式，这些格式不会创建临时文件。