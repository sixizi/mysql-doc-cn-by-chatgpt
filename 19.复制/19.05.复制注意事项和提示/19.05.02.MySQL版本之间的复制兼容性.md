19.5.2 MySQL 版本间的复制兼容性

MySQL 支持从一个发行系列到下一个更高发行系列的复制。例如，您可以从运行 MySQL 5.6 的源复制到运行 MySQL 5.7 的副本，从运行 MySQL 5.7 的源复制到运行 MySQL 8.0 的副本，依此类推。然而，如果源使用的语句或依赖的行为在副本所使用的 MySQL 版本中不再支持，那么在从较旧的源复制到较新的副本时可能会遇到困难。例如，从 MySQL 8.0 开始，不再支持超过 64 个字符的外键名称。

在涉及多个源的复制设置中，不支持使用超过两个 MySQL 服务器版本，无论源或副本 MySQL 服务器的数量如何。这一限制不仅适用于发行系列，也适用于同一发行系列内的版本号。例如，如果您使用链式或环形复制设置，您不能同时使用 MySQL 8.0.22、MySQL 8.0.24 和 MySQL 8.0.28，尽管您可以使用这些发布中的任何两个。

重要提示
强烈建议在给定的 MySQL 发行系列中使用最新发布的版本，因为复制（以及其他）功能正在不断改进。也建议将使用 MySQL 发行系列早期发布版本的源和副本升级到该系列的 GA（生产）发布版本。

从 MySQL 8.0.14 开始，服务器版本将记录在每个事务的二进制日志中，包括最初提交事务的服务器（`original_server_version`）和在复制拓扑中当前服务器的直接源服务器（`immediate_server_version`）。

从较新的源到较旧的副本进行复制可能是可行的，但通常不支持。这是由于多个因素造成的：

- 二进制日志格式变化。二进制日志格式可能在主要版本之间发生变化。虽然我们试图保持向后兼容性，但这并不总是可能的。源可能也启用了一些旧副本无法理解的可选功能，例如二进制日志事务压缩，其结果是压缩的事务负载无法被 MySQL 8.0.20 之前的版本的副本读取。

这对升级复制服务器也有重大影响；有关更多信息，请参见第 19.5.3 节，“升级复制拓扑”。

有关基于行的复制的更多信息，请参见第 19.2.1 节，“复制格式”。

- SQL 不兼容。如果要复制的语句使用源上可用但副本上不可用的 SQL 功能，您不能使用基于语句的复制从较新的源复制到较旧的副本。

然而，如果源和副本都支持基于行的复制，并且没有依赖于源上但在副本上不支持的 SQL 功能的数据定义语句需要复制，您可以使用基于行的复制来复制数据修改语句的效果，即使在源上运行的 DDL 在副本上不受支持。

在 MySQL 8.0.26 中，对复制检测名称进行了不兼容的更改，包括线程阶段的名称，将“master”更改为“source”，将“slave”更改为“replica”，将“mts”（对于“multithreaded slave”）更改为“mta”（对于“multithreaded applier”）。如果这些不兼容的更改对您有影响，可设置 `terminology_use_previous` 系统变量为 `BEFORE_8_0_26`，使 MySQL 服务器使用上一列表中指定对象的

旧版本名称。这使得依赖旧名称的监控工具可以继续工作，直到它们可以更新以使用新名称。

有关潜在复制问题的更多信息，请参见第 19.5.1 节，“复制功能和问题”。