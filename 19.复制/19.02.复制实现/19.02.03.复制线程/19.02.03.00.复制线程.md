### 19.2.3 复制线程

- [19.2.3.1 监控复制主线程](./19.02.03.01.监控复制主线程.md)
- [19.2.3.2 监控复制应用器工作线程](./19.02.03.02.监控复制应用器工作线程.md)

MySQL复制功能是通过以下类型的线程实现的：

- **二进制日志转储线程**。源服务器在副本连接时创建一个线程来发送二进制日志内容给副本。在源服务器上使用`SHOW PROCESSLIST`命令的输出中，可以将此线程识别为Binlog Dump线程。

- **复制I/O接收线程**。在副本服务器上发出`START REPLICA`语句时，副本会创建一个I/O（接收器）线程，该线程连接到源并请求它发送其二进制日志中记录的更新。

  复制接收线程读取源的Binlog Dump线程发送的更新（见前一项）并将它们复制到构成副本中继日志的本地文件中。

  此线程的状态在`SHOW REPLICA STATUS`的输出中显示为`Slave_IO_running`。

- **复制SQL应用器线程**。当`replica_parallel_workers`（在MySQL 8.0.26及更早版本中，使用`slave_parallel_workers`）等于0时，副本创建一个SQL（应用器）线程来读取由复制接收线程写入的中继日志，并执行其中包含的事务。当`replica_parallel_workers`为N >= 1时，有N个应用器线程和一个协调器线程，协调器线程顺序地从中继日志读取事务，并安排它们由工作线程应用。每个工作线程应用协调器分配给它的事务。

你可以通过将系统变量`replica_parallel_workers`（MySQL 8.0.26或更高版本）或`slave_parallel_workers`（MySQL 8.0.26之前的版本）设置为大于0的值来进一步并行化副本上的任务。这样做时，副本将创建指定数量的工作线程来应用事务，加上一个协调器线程，该线程从中继日志读取事务并将它们分配给工作线程。将`replica_parallel_workers`（`slave_parallel_workers`）设置为大于0的值的副本称为多线程副本。如果你正在使用多个复制通道，每个通道都有使用此变量指定的线程数。

> **注意**
>
> 从NDB 8.0.33开始，NDB集群支持多线程副本。（以前，NDB静默地忽略了对`replica_parallel_workers`的任何设置。）更多信息，请参见第25.7.11节，“使用多线程应用器的NDB集群复制”。