#### 19.1.2.1 设置复制源配置

要配置源以使用基于二进制日志文件位置的复制，您必须确保启用了二进制日志，并建立唯一的服务器 ID。

复制拓扑中的每个服务器必须配置有唯一的服务器 ID，您可以使用 `server_id` 系统变量来指定。这个服务器 ID 用于在复制拓扑中识别各个服务器，并且必须是 1 到 (2^32)−1 之间的正整数。从 MySQL 8.0 开始，默认的 `server_id` 值是 1。您可以通过发出如下语句动态更改 `server_id` 的值：

```sql
SET GLOBAL server_id = 2;
```

如何组织和选择服务器 ID 是您的选择，只要每个服务器 ID 与复制拓扑中任何其他服务器使用的服务器 ID 不同。请注意，如果先前为服务器 ID 设置了 0 的值（这是早期版本的默认值），则必须重启服务器以使用新的非零服务器 ID 初始化源。否则，更改服务器 ID 时不需要重启服务器，除非您进行其他需要重启的配置更改。

源上需要启用二进制日志，因为二进制日志是将更改从源复制到其副本的基础。二进制日志默认启用（`log_bin` 系统变量设置为 ON）。`--log-bin` 选项告诉服务器用于二进制日志文件的基本名称。建议您指定此选项，以给二进制日志文件一个非默认基本名称，这样如果主机名更改，您可以轻松地继续使用相同的二进制日志文件名（见 B.3.7 节，“MySQL 中已知的问题”）。如果之前在源上使用 `--skip-log-bin` 选项禁用了二进制日志，您必须在没有此选项的情况下重启服务器以启用它。

> **注意**
>
> 以下选项也会影响源：
>
> - 为了在使用 InnoDB 和事务的复制设置中获得最大可能的持久性和一致性，您应该在源的 `my.cnf` 文件中使用 `innodb_flush_log_at_trx_commit=1` 和 `sync_binlog=1`。
>
> - 确保源上没有启用 `skip_networking` 系统变量。如果已禁用网络，副本无法与源通信，复制失败。