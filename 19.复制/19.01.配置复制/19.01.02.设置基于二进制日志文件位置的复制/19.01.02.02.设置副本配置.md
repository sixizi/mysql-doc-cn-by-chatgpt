#### 19.1.2.2 设置副本配置

每个副本都必须拥有由 `server_id` 系统变量指定的唯一服务器 ID。如果您正在设置多个副本，每一个都必须拥有与源和其他任何副本都不同的唯一的 `server_id` 值。如果副本的服务器 ID 尚未设置，或当前值与您为源或另一个副本选择的值冲突，您必须更改它。

默认的 `server_id` 值是 1。您可以通过发出如下语句动态更改 `server_id` 的值：

```sql
SET GLOBAL server_id = 21;
```

请注意，服务器 ID 的值为 0 会阻止副本连接到源。如果之前设置了该服务器 ID 值（这是早期版本的默认值），您必须重启服务器以使用新的非零服务器 ID 初始化副本。否则，更改服务器 ID 时不需要重启服务器，除非您进行其他需要重启的配置更改。例如，如果在服务器上禁用了二进制日志并且您希望为您的副本启用它，需要重启服务器以启用此功能。

如果您正在关闭副本服务器，您可以编辑配置文件的 [mysqld] 部分以指定唯一的服务器 ID。例如：

```ini
[mysqld]
server-id=21
```

所有服务器默认启用二进制日志。副本不需要启用二进制日志就可以进行复制。然而，在副本上启用二进制日志意味着可以使用副本的二进制日志进行数据备份和崩溃恢复。启用了二进制日志的副本也可以作为更复杂复制拓扑的一部分。例如，您可能想使用这种链式布局设置复制服务器：

```
A -> B -> C
```

这里，A 作为副本 B 的源，B 作为副本 C 的源。为了使这工作，B 必须同时是源和副本。从 A 收到的更新必须由 B 记录到其二进制日志中，以便传递给 C。除了二进制日志之外，这种复制拓扑还要求系统变量 `log_replica_updates`（从 MySQL 8.0.26 开始）或 `log_slave_updates`（在 MySQL 8.0.26 之前）被启用。启用副本更新后，副本会将从源接收并由副本的 SQL 线程执行的更新写入副本自己的二进制日志。`log_replica_updates` 或 `log_slave_updates` 系统变量默认启用。

如果您需要在副本上禁用二进制日志或副本更新日志，您可以通过为副本指定 `--skip-log-bin` 和 `--log-replica-updates=OFF` 或 `--log-slave-updates=OFF` 选项来实现。如果您决定在副本上重新启用这些功能，移除相关选项并重启服务器。