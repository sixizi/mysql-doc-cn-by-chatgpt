### 25.2.6.1 NDB 和 InnoDB 存储引擎之间的差异

NDB 存储引擎采用分布式、共享无结构架构，这使其在许多方面与 InnoDB 不同。对于那些不习惯使用 NDB 的人来说，由于其分布式特性，可能会在事务、外键、表限制和其他特征方面出现意外行为。以下表格展示了这些差异：

表 25.2 InnoDB 和 NDB 存储引擎之间的差异

| 特性                   | InnoDB (MySQL 8.0)                               | NDB 8.0                                                      |
| ---------------------- | ------------------------------------------------ | ------------------------------------------------------------ |
| MySQL 服务器版本       | 8.0                                              | 8.0                                                          |
| InnoDB 版本            | InnoDB 8.0.37                                    | InnoDB 8.0.37                                                |
| NDB 集群版本           | N/A                                              | NDB 8.0.38/8.0.38                                            |
| 存储限制               | 64TB                                             | 128TB                                                        |
| 外键                   | 支持                                             | 支持                                                         |
| 事务                   | 所有标准类型                                     | `READ COMMITTED`                                             |
| MVCC                   | 支持                                             | 不支持                                                       |
| 数据压缩               | 支持                                             | 不支持（NDB 检查点和备份文件可以压缩）                       |
| 大行支持 (> 14K)       | 支持 `VARBINARY`、`VARCHAR`、`BLOB` 和 `TEXT` 列 | 仅支持 `BLOB` 和 `TEXT` 列（使用这些类型存储大量数据可能降低 NDB 性能） |
| 复制支持               | 使用 MySQL 复制的异步和半同步复制；MySQL 组复制  | NDB 集群内的自动同步复制；NDB 集群之间使用 MySQL 复制的异步复制（不支持半同步复制） |
| 读操作扩展             | 支持（使用 MySQL 复制）                          | 支持（NDB 集群中的自动分区；NDB 集群复制）                   |
| 写操作扩展             | 需要应用级别分区（分片）                         | 支持（NDB 集群中的自动分区对应用透明）                       |
| 高可用性 (HA)          | 内置，来自 InnoDB 集群                           | 支持（设计目标为 99.999% 的正常运行时间）                    |
| 节点故障恢复和故障切换 | 使用 MySQL 组复制                                | 自动（NDB 架构中的关键元素）                                 |
| 节点故障恢复时间       | 30 秒或更长                                      | 通常 < 1 秒                                                  |
| 实时性能               | 不支持                                           | 支持                                                         |
| 内存表                 | 不支持                                           | 支持（某些数据可以选择性地存储在磁盘上；内存和磁盘数据存储均具有持久性） |
| NoSQL 存储引擎访问     | 支持                                             | 支持（多种 API，包括 Memcached、Node.js/JavaScript、Java、JPA、C++ 和 HTTP/REST） |
| 并发和并行写入         | 支持                                             | 支持多达 48 个写入器，针对并发写入进行了优化                 |
| 冲突检测和解决（多源） | 支持（MySQL 组复制）                             | 支持                                                         |
| 哈希索引               | 不支持                                           | 支持                                                         |
| 在线添加节点           | 使用 MySQL 组复制的读/写副本                     | 支持（所有节点类型）                                         |
| 在线升级               | 支持（使用复制）                                 | 支持                                                         |
| 在线模式修改           | 支持，作为 MySQL 8.0 的一部分                    | 支持                                                         |

这些差异反映了 NDB 和 InnoDB 在设计和实现上的不同，可能会影响它们在不同应用场景中的适用性。