### 25.4.2.1 NDB Cluster 数据节点配置参数

本节列出的参数信息用于 `config.ini` 文件中的 `[ndbd]` 或 `[ndbd default]` 部分，用于配置 NDB Cluster 数据节点。有关每个参数的详细描述和其他附加信息，请参见 [第 25.4.3.6 节 “定义 NDB Cluster 数据节点”](#25.4.3.6-defining-ndb-cluster-data-nodes)。

这些参数也适用于 `ndbmtd`，即多线程版本的 `ndbd`。接下来还列出了特定于 `ndbmtd` 的参数。

- `Arbitration`：在节点故障时，如何执行仲裁以避免脑裂问题。
- `ArbitrationTimeout`：数据库分区等待仲裁信号的最长时间（毫秒）。
- `BackupDataBufferSize`：备份数据缓冲区的默认大小（字节）。
- `BackupDataDir`：存储备份的路径。注意，字符串 `'/BACKUP'` 始终附加到此设置中，因此*有效*的默认值为 `FileSystemPath/BACKUP`。
- `BackupDiskWriteSpeedPct`：设置数据节点的分配最大写入速度（`MaxDiskWriteSpeed`）的百分比，以在开始备份时保留给 LCP。
- `BackupLogBufferSize`：备份日志缓冲区的默认大小（字节）。
- `BackupMaxWriteSize`：备份进行的文件系统写入的最大大小（字节）。
- `BackupMemory`：每个节点分配给备份的总内存（字节）。
- `BackupReportFrequency`：备份期间备份状态报告的频率（秒）。
- `BackupWriteSize`：备份进行的文件系统写入的默认大小（字节）。
- `BatchSizePerLocalScan`：用于计算带保持锁定扫描的锁记录数量。
- `BuildIndexThreads`：在系统或节点重启期间用于构建有序索引的线程数。当运行 `ndb_restore --rebuild-indexes` 时也适用。将此参数设置为 0 会禁用多线程构建有序索引。
- `CompressedBackup`：在写入时使用 zlib 压缩备份。
- `CompressedLCP`：使用 zlib 写入压缩 LCP。
- `ConnectCheckIntervalDelay`：数据节点连接性检查阶段之间的时间间隔。在一个间隔内无响应后数据节点被认为是可疑的，在两个间隔内无响应后被认为是死的。
- `CrashOnCorruptedTuple`：启用后，当检测到损坏的元组时强制节点关闭。
- `DataDir`：此节点的数据目录。
- `DataMemory`：每个数据节点分配用于存储数据的字节数；受可用系统 RAM 和 `IndexMemory` 大小的限制。
- `DefaultHashMapSize`：设置表哈希映射使用的大小（桶）。支持三个值：0、240 和 3840。
- `DictTrace`：启用 `DBDICT` 调试；用于 NDB 开发。
- `DiskDataUsingSameDisk`：如果磁盘数据表空间位于不同的物理磁盘上，请设置为 `false`。
- `DiskIOThreadPool`：文件访问的未绑定线程数，仅适用于磁盘数据。
- `Diskless`：在不使用磁盘的情况下运行。
- `DiskPageBufferEntries`：在 `DiskPageBufferMemory` 中分配的内存；非常大的磁盘事务可能需要增加此值。
- `DiskPageBufferMemory`：每个数据节点分配的磁盘页缓冲缓存的字节数。
- `DiskSyncSize`：在强制同步之前写入文件的数据量。
- `EnablePartialLcp`：启用部分 LCP（`true`）；如果禁用（`false`），则所有 LCP 写入完整的检查点。
- `EnableRedoControl`：启用自适应检查点速度以控制重做日志的使用。
- `EncryptedFileSystem`：加密本地检查点和表空间文件。实验性质；不支持在生产环境中使用。
- `EventLogBufferSize`：数据节点内 NDB 日志事件的循环缓冲区大小。
- `ExecuteOnComputer`：引用先前定义的 `COMPUTER` 的字符串。
- `ExtraSendBufferMemory`：除 `TotalSendBufferMemory` 或 `SendBufferMemory` 分配的任何内存外，用于发送缓冲区的内存。默认值（0）允许最多 16MB。
- `FileSystemPath`：数据节点存储其数据的目录路径（目录必须存在）。
- `FileSystemPathDataFiles`：数据节点存储其磁盘数据文件的目录路径。默认值为 `FilesystemPathDD`（如果设置）；否则，使用 `FileSystemPath`（如果设置）；否则，使用 `DataDir` 的值。
- `FileSystemPathDD`：数据节点存储其磁盘数据和撤销文件的目录路径。默认值为 `FileSystemPath`（如果设置）；否则，使用 `DataDir` 的值。
- `FileSystemPathUndoFiles`：数据节点存储其磁盘数据撤销文件的目录路径。默认值为 `FileSystemPathDD`（如果设置）；否则，使用 `FileSystemPath`（如果设置）；否则，使用 `DataDir` 的值。
- `FragmentLogFileSize`：每个重做日志文件的大小。
- `HeartbeatIntervalDbApi`：API 节点-数据节点心跳之间的时间间隔。（在错过 3 次心跳后关闭 API 连接）。
- `HeartbeatIntervalDbDb`：数据节点到数据节点心跳之间的时间间隔；在错过 3 次心跳后被认为是死的。
- `HeartbeatOrder`：设置数据节点检查彼此心跳的顺序，以确定给定节点是否仍然活动并连接到集群。对于所有数据节点，必须为零或对于所有数据节点为不同的非零值；有关进一步指导，请参阅文档。
- `HostName`：此数据节点的主机名或 IP 地址。
- `IndexMemory`：每个数据节点分配的用于存储索引的字节数；受可用系统 RAM 和 `DataMemory` 大小的限制。
- `IndexStatAutoCreate`：启用/禁用在创建索引时的自动统计收集。
- `IndexStatAutoUpdate`：监控索引的更改并触发自动统计更新。
- `IndexStatSaveScale`：确定存储索引统计信息大小时使用的缩放因子。
- `IndexStatSaveSize`：每个索引的保存统计信息的最大大小（字节）。
- `IndexStatTriggerPct`：用于索引统计信息更新的 DML 操作百分比变化阈值。值由 `IndexStatTriggerScale` 缩放。
- `IndexStatTriggerScale`：按此数量缩放 `IndexStatTriggerPct`，乘以索引大小的以 2 为底的对数，用于大型索引。设置为 0 以禁用缩放。
- `IndexStatUpdateDelay`：给定索引的自动索引统计信息更新之间的最小延迟。0 表示没有延迟。
- `InitFragmentLogFiles`：初始化碎片日志文件，使用稀疏或完整格式。
- `InitialLogFileGroup`：描述初始启动期间创建的日志文件组。有关格式，请参阅文档。
- `InitialNoOfOpenFiles`：每个数据节点初始打开的文件数。（每个文件创建一个线程）。
- `InitialTablespace`：描述初始启动期间创建的表空间。有关格式，请参阅文档。
- `InsertRecoveryWork`：用于插入行的 `RecoveryWork` 的百分比；仅在使用部分本地检查点时有效。
- `KeepAliveSendInterval`：数据节点之间的链接之间的保持活动信号的时间间隔（毫秒）。设置为 0 以禁用。
- `LateAlloc`：在与管理服务器建立连接后分配内存。
- `LcpScanProgressTimeout`：本地检查点碎片扫描可以停滞的最长时间，以确保系统范围内的 LCP 进展。使用 0 以禁用。
- `LocationDomainId`：将此数据节点分配给特定的可用性域或区域。0（默认）表示未设置。
- `LockExecuteThreadToCPU`：以逗号分隔的 CPU ID 列表。
- `LockMaintThreadsToCPU`：运行维护线程的 CPU ID。
- `LockPagesInMainMemory`：0=禁用锁定，1=在内存分配后锁定，2=在内存分配前锁定。
- `LogLevelCheckpoint`：打印到 `stdout` 的本地和全局检查点信息的日志级别。
- `LogLevelCongestion`：打印到 `stdout` 的拥塞信息级别。
- `LogLevelConnection`：打印到 `stdout` 的节点连接/断开信息级别。
- `LogLevelError`：打印到
-  `stdout` 的传输器、心跳错误。
  - `LogLevelInfo`：打印到 `stdout` 的心跳和日志信息。
  - `LogLevelNodeRestart`：打印到 `stdout` 的节点重启和节点故障信息级别。
  - `LogLevelShutdown`：打印到 `stdout` 的节点关闭信息级别。
  - `LogLevelStartup`：打印到 `stdout` 的节点启动信息级别。
  - `LogLevelStatistic`：打印到 `stdout` 的事务、操作和传输器信息级别。
  - `LongMessageBuffer`：每个数据节点分配的内部长消息的字节数。
  - `MaxAllocate`：不再使用；无效。
  - `MaxBufferedEpochs`：订阅节点可以滞后的允许纪元数（未处理的纪元）。超过会导致滞后的订阅者断开连接。
  - `MaxBufferedEpochBytes`：分配用于缓冲纪元的总字节数。
  - `MaxDiskDataLatency`：在开始中止事务之前，磁盘访问的最大允许平均延迟（毫秒）。
  - `MaxDiskWriteSpeed`：在没有重启时，LCP 和备份每秒可以写入的最大字节数。
  - `MaxDiskWriteSpeedOtherNodeRestart`：在其他节点重启时，LCP 和备份每秒可以写入的最大字节数。
  - `MaxDiskWriteSpeedOwnRestart`：在此节点重启时，LCP 和备份每秒可以写入的最大字节数。
  - `MaxFKBuildBatchSize`：用于构建外键的最大扫描批大小。增加此值可能会加快外键的构建速度，但也会影响正在进行的流量。
  - `MaxDMLOperationsPerTransaction`：限制事务的大小；如果事务需要超过此数量的 DML 操作，则中止事务。
  - `MaxLCPStartDelay`：LCP 轮询检查点互斥的时间（秒），以允许其他数据节点完成元数据同步，然后将自己置于锁队列中以进行表数据的并行恢复。
  - `MaxNoOfAttributes`：建议存储在数据库中的属性总数（所有表的总和）。
  - `MaxNoOfConcurrentIndexOperations`：在一个数据节点上可以同时执行的总索引操作数。
  - `MaxNoOfConcurrentOperations`：事务协调器中的最大操作记录数。
  - `MaxNoOfConcurrentScans`：在数据节点上同时执行的最大扫描数。
  - `MaxNoOfConcurrentSubOperations`：同时执行的最大订阅操作数。
  - `MaxNoOfConcurrentTransactions`：在此数据节点上同时执行的最大事务数，可以同时执行的事务总数是此值乘以集群中的数据节点数。
  - `MaxNoOfFiredTriggers`：在一个数据节点上可以同时触发的触发器总数。
  - `MaxNoOfLocalOperations`：在此数据节点上定义的最大操作记录数。
  - `MaxNoOfLocalScans`：在此数据节点上并行进行的最大碎片扫描数。
  - `MaxNoOfOpenFiles`：每个数据节点打开的最大文件数。（每个文件创建一个线程）。
  - `MaxNoOfOrderedIndexes`：系统中可以定义的有序索引总数。
  - `MaxNoOfSavedMessages`：写入错误日志的最大错误消息数和保留的最大跟踪文件数。
  - `MaxNoOfSubscribers`：订阅者的最大数量。
  - `MaxNoOfSubscriptions`：订阅的最大数量（默认值 0 = `MaxNoOfTables`）。
  - `MaxNoOfTables`：建议存储在数据库中的 NDB 表的总数。
  - `MaxNoOfTriggers`：系统中可以定义的触发器总数。
  - `MaxNoOfUniqueHashIndexes`：系统中可以定义的唯一哈希索引总数。
  - `MaxParallelCopyInstances`：节点重启期间的并行副本数。默认值为 0，这会使用两个节点上的 LDM 数量，最大为 16。
  - `MaxParallelScansPerFragment`：每个碎片的最大并行扫描数。一旦达到此限制，扫描将被序列化。
  - `MaxReorgBuildBatchSize`：用于重新组织表分区的最大扫描批大小。增加此值可能会加快表分区的重新组织速度，但也会影响正在进行的流量。
  - `MaxStartFailRetries`：数据节点启动失败时的最大重试次数，需要 `StopOnError = 0`。设置为 0 将导致启动尝试无限期进行。
  - `MaxUIBuildBatchSize`：用于构建唯一键的最大扫描批大小。增加此值可能会加快唯一键的构建速度，但也会影响正在进行的流量。
  - `MemReportFrequency`：内存报告的频率（秒）；0 = 仅在超过百分比限制时报告。
  - `MinDiskWriteSpeed`：LCP 和备份每秒可以写入的最小字节数。
  - `MinFreePct`：为重启保留的内存资源百分比。
  - `NodeGroup`：数据节点所属的节点组；仅在集群初始启动期间使用。
  - `NodeGroupTransporters`：同一节点组内节点之间使用的传输器数量。
  - `NodeId`：在集群中唯一标识数据节点的编号。
  - `NoOfFragmentLogFiles`：每个数据节点所属的 4 个文件集中每个文件集的 16 MB 重做日志文件数。
  - `NoOfReplicas`：数据库中所有数据的副本数量。
  - `Numa`：（仅限 Linux；需要 `libnuma`）控制 NUMA 支持。设置为 0 允许系统确定数据节点进程使用的交错；1 表示由数据节点确定。
  - `ODirect`：尽可能使用 `O_DIRECT` 文件读取和写入。
  - `ODirectSyncFlag`：`O_DIRECT` 写入被视为同步写入；当未启用 `ODirect`、`InitFragmentLogFiles` 设置为 `SPARSE` 或两者都设置时被忽略。
  - `RealtimeScheduler`：当为 `true` 时，数据节点线程作为实时线程调度。默认值为 `false`。
  - `RecoveryWork`：LCP 文件的存储开销百分比：值越大，正常操作中的工作量越少，恢复时的工作量越大。
  - `RedoBuffer`：每个数据节点分配用于写入重做日志的字节数。
  - `RedoOverCommitCounter`：当超过 `RedoOverCommitLimit` 此多次时，中止事务，并按 `DefaultOperationRedoProblemAction` 处理操作。
  - `RedoOverCommitLimit`：每次刷新当前重做缓冲区花费的时间超过此秒数时，比较发生的次数与 `RedoOverCommitCounter`。
  - `RequireEncryptedBackup`：备份是否必须加密（1 = 需要加密，否则为 0）。
  - `ReservedConcurrentIndexOperations`：在一个数据节点上具有专用资源的同时索引操作数。
  - `ReservedConcurrentOperations`：在一个数据节点上的事务协调器中具有专用资源的同时操作数。
  - `ReservedConcurrentScans`：在一个数据节点上具有专用资源的同时扫描数。
  - `ReservedConcurrentTransactions`：在一个数据节点上具有专用资源的同时事务数。
  - `ReservedFiredTriggers`：在一个数据节点上具有专用资源的触发器数。
  - `ReservedLocalScans`：在一个数据节点上具有专用资源的同时碎片扫描数。
  - `ReservedTransactionBufferMemory`：为每个数据节点分配的用于键和属性数据的动态缓冲空间（字节）。
  - `RestartOnErrorInsert`：控制插入错误导致的重启类型（当 `StopOnError` 启用时）。
  - `RestartSubscriberConnectTimeout`：数据节点等待订阅 API 节点连接的时间。设置为 0 以禁用超时，始终解析为最接近的整秒。
  - `SchedulerExecutionTimer`：在调度程序中执行的微秒数，然后发送。
  - `SchedulerResponsiveness`：设置 NDB 调度程序响应优化 0-10；较高的值提供更好的响应时间，但吞吐量较低。
  - `SchedulerSpinTimer`：在调度程序中执行的微秒数，然后休眠。
  - `ServerPort`：用于设置传输器的端口，以便来自 API 节点的传入连接。
  - `SharedGlobalMemory`：每个数据节点分配的总字节数，可用于任何用途。
  - `SpinMethod`：确定数据节点使用的旋转方法；有关详细信息，请参阅文档。
  - `StartFailRetryDelay`：启动失败后的延迟时间（秒），然后重试；需要 `StopOnError = 0`。
  - `StartFailureTimeout`：终止前等待的毫秒数。（0=永远等待）。
  - `StartNoNodeGroupTimeout`：在尝试启动之前等待无节点组的节点的时间（0=永远）。
  - `StartPartialTimeout`：在尝试启动而不包括所有节点之前等待
  - 的毫秒数。（0=永远等待）。
    - `StartPartitionedTimeout`：在尝试分区启动之前等待的毫秒数。（0=永远等待）。
    - `StartupStatusReportFrequency`：启动期间状态报告的频率。
    - `StopOnError`：当设置为 0 时，数据节点在节点故障后自动重启并恢复。
    - `StringMemory`：字符串内存的默认大小（0 到 100 = 最大值的百分比，101+ = 实际字节）。
    - `TcpBind_INADDR_ANY`：绑定 `IP_ADDR_ANY` 以便可以从任何地方进行连接（用于自动生成的连接）。
    - `TimeBetweenEpochs`：纪元之间的时间（用于复制的同步）。
    - `TimeBetweenEpochsTimeout`：纪元之间的超时时间。超时会导致节点关闭。
    - `TimeBetweenGlobalCheckpoints`：将事务组提交到磁盘之间的时间。
    - `TimeBetweenGlobalCheckpointsTimeout`：事务组提交到磁盘的最小超时时间。
    - `TimeBetweenInactiveTransactionAbortCheck`：检查非活动事务之间的时间。
    - `TimeBetweenLocalCheckpoints`：对数据库进行快照之间的时间（以字节为单位的以 2 为底的对数表示）。
    - `TimeBetweenWatchDogCheck`：在数据节点内部执行检查之间的时间。
    - `TimeBetweenWatchDogCheckInitial`：在数据节点的早期启动阶段分配内存时执行检查之间的时间。
    - `TotalSendBufferMemory`：用于所有传输器发送缓冲区的总内存。
    - `TransactionBufferMemory`：为每个数据节点分配的用于键和属性数据的动态缓冲空间（字节）。
    - `TransactionDeadlockDetectionTimeout`：事务可以在数据节点内执行的时间。这是事务协调器等待参与事务的每个数据节点执行请求的时间。如果数据节点花费的时间超过此时间，则事务将被中止。
    - `TransactionInactiveTimeout`：应用程序在执行事务的另一部分之前等待的毫秒数。这是事务协调器等待应用程序执行或发送事务的另一部分（查询、语句）的时间。如果应用程序花费的时间过长，则事务将被中止。超时 = 0 表示应用程序永远不会超时。
    - `TransactionMemory`：为每个数据节点分配的用于事务的内存。
    - `TwoPassInitialNodeRestartCopy`：在初始节点重启期间分两次复制数据，这使得在此类重启期间能够多线程构建有序索引。
    - `UndoDataBuffer`：未使用；无效。
    - `UndoIndexBuffer`：未使用；无效。
    - `UseShm`：在此主机上也运行的 API 节点与数据节点之间使用共享内存连接。
    - `WatchDogImmediateKill`：为 `true` 时，只要发生看门狗问题，线程立即被杀死；用于测试和调试。

    以下参数是特定于 `ndbmtd` 的：

    - `AutomaticThreadConfig`：使用自动线程配置；覆盖任何 `ThreadConfig` 和 `MaxNoOfExecutionThreads` 的设置，并禁用 `ClassicFragmentation`。
    - `ClassicFragmentation`：为 `true` 时，使用传统的表碎片；设置为 `false` 以在 LDM 之间启用灵活的碎片分布。由 `AutomaticThreadConfig` 禁用。
    - `EnableMultithreadedBackup`：启用多线程备份。
    - `MaxNoOfExecutionThreads`：仅适用于 `ndbmtd`，指定最大执行线程数。
    - `MaxSendDelay`：`ndbmtd` 延迟发送的最大微秒数。
    - `NoOfFragmentLogParts`：属于此数据节点的重做日志文件组数。
    - `NumCPUs`：使用 `AutomaticThreadConfig` 指定的 CPU 数量。
    - `PartitionsPerNode`：确定在每个数据节点上创建的表分区数量；如果启用了 `ClassicFragmentation`，则不使用。
    - `ThreadConfig`：用于多线程数据节点（`ndbmtd`）的配置。默认值为空字符串；有关语法和其他信息，请参阅文档。