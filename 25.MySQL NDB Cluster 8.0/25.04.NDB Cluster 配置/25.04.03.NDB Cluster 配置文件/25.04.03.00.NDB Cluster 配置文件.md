### 25.4.3 NDB Cluster 配置文件

- [25.4.3.1 NDB Cluster 配置：基本示例](./25.04.03.01.NDB Cluster 配置：基本示例.md)
- [25.4.3.2 NDB Cluster 推荐的初始配置](./25.04.03.02.NDB Cluster 推荐的初始配置.md)
- [25.4.3.3 NDB Cluster 连接字符串](./25.04.03.03.NDB Cluster 连接字符串.md)
- [25.4.3.4 定义 NDB Cluster 中的计算机](./25.04.03.04.定义 NDB Cluster 中的计算机.md)
- [25.4.3.5 定义 NDB Cluster 管理服务器](./25.04.03.05.定义 NDB Cluster 管理服务器.md)
- [25.4.3.6 定义 NDB Cluster 数据节点](./25.04.03.06.定义 NDB Cluster 数据节点.md)
- [25.4.3.7 定义 NDB Cluster 中的 SQL 和其他 API 节点](./25.04.03.07.定义 NDB Cluster 中的 SQL 和其他 API 节点.md)
- [25.4.3.8 定义系统](./25.04.03.08.定义系统.md)
- [25.4.3.9 NDB Cluster 的 MySQL 服务器选项和变量](./25.04.03.09.NDB Cluster 的 MySQL 服务器选项和变量.md)
- [25.4.3.10 NDB Cluster TCP/IP 连接](./25.04.03.10.NDB Cluster TCPIP 连接.md)
- [25.4.3.11 使用直接连接的 NDB Cluster TCP/IP 连接](./25.04.03.11.使用直接连接的 NDB Cluster TCPIP 连接.md)
- [25.4.3.12 NDB Cluster 共享内存连接](./25.04.03.12.NDB Cluster 共享内存连接.md)
- [25.4.3.13 数据节点内存管理](./25.04.03.13.数据节点内存管理.md)
- [25.4.3.14 配置 NDB Cluster 发送缓冲区参数](./25.04.03.14.配置 NDB Cluster 发送缓冲区参数.md)

配置 NDB Cluster 需要使用两个文件：

`my.cnf`：指定所有 NDB Cluster 可执行文件的选项。此文件必须被集群中每个可执行文件访问，您应该已经在以前使用 MySQL 时熟悉此文件。

`config.ini`：此文件有时称为全局配置文件，仅由 NDB Cluster 管理服务器读取，然后将其中包含的信息分发给集群中的所有进程。`config.ini` 包含集群中每个节点的描述。这包括数据节点的配置参数以及集群中所有节点之间连接的配置参数。有关此文件中可能出现的部分以及每个部分中可以放置哪些类型的配置参数的快速参考，请参见 [config.ini 文件的部分](#config-ini-文件的部分)。

配置数据的缓存。NDB 使用有状态配置。管理服务器每次重新启动时，不是每次都读取全局配置文件，而是管理服务器在第一次启动时缓存配置，从那以后，只有在以下任一条件为真时，才会读取全局配置文件：

- 使用 `--initial` 选项启动管理服务器。使用 `--initial` 时，会重新读取全局配置文件，删除所有现有的缓存文件，并由管理服务器创建新的配置缓存。
- 使用 `--reload` 选项启动管理服务器。`--reload` 选项会使管理服务器将其缓存与全局配置文件进行比较。如果它们不同，管理服务器将创建新的配置缓存；任何现有的配置缓存都会保留但不会使用。如果管理服务器的缓存和全局配置文件包含相同的配置数据，则使用现有缓存，不会创建新的缓存。
- 使用 `--config-cache=FALSE` 选项启动管理服务器。此选项禁用 `--config-cache`（默认启用），可用于强制管理服务器完全绕过配置缓存。在这种情况下，管理服务器会忽略可能存在的任何配置文件，而总是从 `config.ini` 文件读取其配置数据。
- 未找到配置缓存。在这种情况下，管理服务器会读取全局配置文件并创建包含与文件中相同配置数据的缓存。

配置缓存文件。默认情况下，管理服务器在 MySQL 安装目录中的名为 `mysql-cluster` 的目录中创建配置缓存文件。（如果在 Unix 系统上从源代码构建 NDB Cluster，则默认位置是 `/usr/local/mysql-cluster`。）这可以通过在运行时使用 `--configdir` 选项启动管理服务器来覆盖。配置缓存文件是二进制文件，其命名模式为 `ndb_node_622424198204195214_config.bin.seq_622424198204195214`，其中 `node_622424198204195214` 是集群中管理服务器的节点 622424198204195214，`seq_622424198204195214` 是缓存标识符。缓存文件按创建顺序顺序编号，管理服务器使用由 `seq_622424198204195214` 确定的最新缓存文件。

> **注意**
>
> 可以通过删除较晚的配置缓存文件或重命名较早的缓存文件以使其具有较高的 `seq_622424198204195214` 来回滚到以前的配置。然而，由于配置缓存文件是以二进制格式编写的，因此不应尝试手动编辑其内容。

有关 NDB Cluster 管理服务器的 `--configdir`、`--config-cache`、`--initial` 和 `--reload` 选项的更多信息，请参见 [第 25.5.4 节，“ndb_mgmd — NDB Cluster 管理服务器守护进程”](#ndb_mgmd-ndb-cluster-管理服务器守护进程)。

我们在 NDB Cluster 配置方面不断进行改进，并试图简化这一过程。尽管我们努力保持向后兼容，但有时可能会引入不兼容的更改。在这种情况下，我们会尽量提前通知 NDB Cluster 用户更改不向后兼容。如果您发现此类更改且我们未记录，请按照 [第 1.5 节，“如何报告错误或问题”](#如何报告错误或问题) 中给出的说明在 MySQL 错误数据库中报告。