### 25.4.3.5 定义 NDB Cluster 管理服务器

`[ndb_mgmd]` 部分用于配置管理服务器的行为。如果使用多个管理服务器，可以在 `[ndb_mgmd default]` 部分中指定它们的共同参数。`[mgm]` 和 `[mgm default]` 是这些的旧别名，为了向后兼容而支持。

以下列表中的所有参数都是可选的，如果省略，则假定为默认值。

> **注意**
> 如果既没有 `ExecuteOnComputer` 参数也没有 `HostName` 参数，则默认值为 `localhost`。

#### Id

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 无符号整数                                                   |
| 默认值             | [...]                                                        |
| 范围               | 1 - 255                                                      |
| 重启类型           | 初始系统重启                                                 |
| 描述               | 每个集群节点都有唯一标识。对于管理节点，这是一个在 1 到 255 范围内的整数值。该 ID 由所有内部集群消息用于寻址节点，因此必须对每个 NDB Cluster 节点唯一，不论节点类型如何。<br><br>**注意**：数据节点 ID 必须小于 145。如果计划部署大量数据节点，建议将管理节点（和 API 节点）的节点 ID 限制为大于 144 的值。<br><br>使用 `Id` 参数标识管理节点已被弃用，建议使用 `NodeId`。尽管 `Id` 仍然为了向后兼容而支持，但现在会生成警告，并可能在未来版本的 NDB Cluster 中删除。 |

#### NodeId

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 无符号整数                                                   |
| 默认值             | [...]                                                        |
| 范围               | 1 - 255                                                      |
| 重启类型           | 初始系统重启                                                 |
| 描述               | 每个集群节点都有唯一标识。对于管理节点，这是一个在 1 到 255 范围内的整数值。该 ID 由所有内部集群消息用于寻址节点，因此必须对每个 NDB Cluster 节点唯一，不论节点类型如何。<br><br>**注意**：数据节点 ID 必须小于 145。如果计划部署大量数据节点，建议将管理节点（和 API 节点）的节点 ID 限制为大于 144 的值。<br><br>`NodeId` 是标识管理节点的首选参数名。尽管较旧的 `Id` 参数仍然为了向后兼容而支持，但它现在已被弃用，并在使用时生成警告；也可能在未来的 NDB Cluster 版本中删除。 |

#### ExecuteOnComputer

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 名称                                                         |
| 默认值             | [...]                                                        |
| 范围               | ...                                                          |
| 重启类型           | 系统重启                                                     |
| 描述               | 参考 `config.ini` 文件 `[computer]` 部分中定义的计算机的 `Id`。<br><br>**重要**：此参数已被弃用，未来版本中可能会删除。请改用 `HostName` 参数。 |

#### PortNumber

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 无符号整数                                                   |
| 默认值             | 1186                                                         |
| 范围               | 0 - 64K                                                      |
| 重启类型           | 系统重启                                                     |
| 描述               | 管理服务器监听配置请求和管理命令的端口号。<br><br>该节点的节点 ID 只能分配给明确请求它的连接。请求“任何”节点 ID 的管理服务器不能使用此 ID。此参数可用于在同一主机上运行多个管理服务器，并且 `HostName` 不足以区分进程时使用。用于测试。 |

#### HostName

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 名称或 IP 地址                                               |
| 默认值             | [...]                                                        |
| 范围               | ...                                                          |
| 重启类型           | 节点重启                                                     |
| 描述               | 指定该参数可以定义管理节点所在计算机的主机名。使用 `HostName` 来指定 `localhost` 以外的主机名。 |

#### LocationDomainId

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | 整数                                                         |
| 默认值             | 0                                                            |
| 范围               | 0 - 16                                                       |
| 重启类型           | 系统重启                                                     |
| 描述               | 将管理节点分配到云中的特定可用性域（也称为可用性区）。通过告知 NDB 哪些节点在哪些可用性域，可以在云环境中提高性能：<br><br>- 如果请求的数据未在同一节点上找到，可以将读取操作定向到同一可用性域中的其他节点。<br>- 不同可用性域之间的节点通信确保使用 NDB 传输器的 WAN 支持，无需进一步手动干预。<br>- 传输器的组号可以基于使用的可用性域，这样也可以使 SQL 和其他 API 节点尽可能与同一可用性域中的本地数据节点通信。<br>- 仲裁器可以从没有数据节点的可用性域中选择，如果找不到这样的可用性域，则从第三个可用性域中选择。<br><br>`LocationDomainId` 取值范围为 0 到 16，默认为 0；使用 0 与不设置该参数相同。 |

#### LogDestination

| 属性               | 值                                                           |
| ------------------ | ------------------------------------------------------------ |
| 版本（或更高版本） | NDB 8.0.13                                                   |
| 类型或单位         | `{CONSOLE|SYSLOG|FILE}`                                      |
| 默认值             | `FILE: filename=ndb_nodeid_cluster.log, maxsize=1000000, maxfiles=6` |
| 范围               | ...                                                          |
| 重启类型           | 节点重启                                                     |
| 描述               | 此参数指定将集群日志信息发送到哪里。有三种选项：`CONSOLE`、`SYSLOG` 和 `FILE`，默认值为 `FILE`：<br><br>- `CONSOLE` 将日志输出到 `stdout`：<br>`CONSOLE`<br>- `SYSLOG` 将日志发送到 `syslog` 设施，可能的值为 `auth`、`authpriv`、`cron`、`daemon`、`ftp`、`kern`、`lpr`、`mail`、`news`、`syslog`、`user`、`uucp`、`local0`、`local1`、`local2`、`local3`、`local4`、`local5`、`local6` 或 `local7`。<br>**注意**：并非每个操作系统都支持每个设施。<br>`SYSLOG:facility=syslog`<br>- `FILE` 将集群日志输出到同一台机器上的常规文件。可以指定以下值：<br> - `filename`：日志文件名。<br> - 默认日志文件名为 `ndb_nodeid_cluster.log`。<br> - `maxsize`：文件可以增长到的最大大小（以字节为单位），然后日志记录滚动到新文件。当这种情况发生时，旧日志文件通过在文件名后附加 `.N` 进行重命名，其中 `N` 是尚未使用的下一个编号。<br> - `maxfiles`：日志文件的最大数量。<br>`FILE:filename=cluster.log,maxsize=1000000,maxfiles=6`<br> `FILE` 参数的默认值为 `FILE:filename=ndb_node_id_cluster.log,maxsize=1000000,maxfiles=6`，其中 `node_id` 是节点的 ID。<br> 可以用分号分隔符指定多个日志目的地，如下所示：<br>`CONSOLE;SYSLOG:facility=local0;FILE:filename=/var/log/mgmd` |

#### ArbitrationRank

| 属性               | 值         |
| ------------------ | ---------- |
| 版本（或更高版本） | NDB 8.0.13 |
| 类型或单位         | 0-2        |
| 默认值             | 1          |
| 范围               | 0 - 2      |