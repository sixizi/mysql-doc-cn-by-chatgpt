#### 20.5.4.3 配置分布式恢复

MySQL 中的组复制分布式恢复过程有几个方面可以根据您的系统需要进行配置。

##### 连接尝试次数

对于从二进制日志进行状态传输，组复制限制了加入成员尝试连接到捐赠者池中捐赠者的尝试次数。如果在未成功连接的情况下达到连接重试限制，分布式恢复过程将以错误终止。请注意，此限制指定了加入成员连接到捐赠者的总尝试次数。例如，如果有2个组成员是合适的捐赠者，且连接重试限制设置为4，则加入成员在达到限制前会尝试连接每个捐赠者2次。

默认的连接重试限制是10次。您可以使用 `group_replication_recovery_retry_count` 系统变量来配置此设置。以下命令将连接到捐赠者的最大尝试次数设置为5：

```sql
mysql> SET GLOBAL group_replication_recovery_retry_count= 5;
```

对于远程克隆操作，此限制不适用。组复制只会对每个合适的捐赠者进行一次连接尝试，然后开始尝试从二进制日志进行状态传输。

##### 连接尝试间的睡眠间隔

对于从二进制日志进行状态传输，`group_replication_recovery_reconnect_interval` 系统变量定义了分布式恢复过程在捐赠者连接尝试之间应该睡眠的时间。请注意，分布式恢复不会在每次捐赠者连接尝试后都睡眠。由于加入成员连接的是不同的服务器，而不是反复连接同一个服务器，因此可以假设影响服务器A的问题不会影响服务器B。因此，只有在尝试了所有可能的捐赠者后，分布式恢复才会暂停。一旦加入组的服务器尝试连接组中每个合适的捐赠者一次后，分布式恢复过程就会根据 `group_replication_recovery_reconnect_interval` 系统变量配置的秒数进行睡眠。例如，如果有2个组成员是合适的捐赠者，且连接重试限制设置为4，则加入成员会尝试连接每个捐赠者一次，然后睡眠连接重试间隔时间，然后再尝试连接每个捐赠者一次，直到达到限制。

默认的连接重试间隔是60秒，您可以动态更改此值。以下命令将分布式恢复捐赠者连接重试间隔设置为120秒：

```sql
mysql> SET GLOBAL group_replication_recovery_reconnect_interval= 120;
```

对于远程克隆操作，此间隔不适用。组复制只会对每个合适的捐赠者进行一次连接尝试，然后开始尝试从二进制日志进行状态传输。

##### 标记加入成员为在线
当分布式恢复成功完成从捐赠者到加入成员的状态传输后，可以将加入成员标记为在线并准备参与组内活动。默认情况下，这是在加入成员接收并应用了所有缺失的事务之后完成的。您可以选择性地允许在加入成员接收并认证（即完成冲突检测）所有缺失的事务，但在应用它们之前就将其标记为在线。如果您想这样做，请使用 `group_replication_recovery_complete_at` 系统变量来指定另一种设置 `TRANSACTIONS_CERTIFIED`。