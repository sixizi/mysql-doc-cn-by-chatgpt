#### 20.1.4.2 故障检测

群组复制的故障检测机制是一个分布式服务，能够识别群组中的服务器是否未与其他服务器通信，因此怀疑它已经停止服务。如果群组的共识认为这种怀疑很可能是真的，群组将协调决定将该成员驱逐。驱逐一个未进行通信的成员是必要的，因为群组需要其多数成员就事务或视图变更达成一致。如果某成员没有参与这些决策，群组必须将其移除，以增加群组包含正确工作成员多数的可能性，从而继续处理事务。

在复制群组中，每个成员都与其他每个成员之间有点对点的通信渠道，形成一个完全连接的图。这些连接由群组通信引擎（XCom，一个Paxos变种）管理，并使用TCP/IP套接字。一个通道用于向成员发送消息，另一个通道用于从成员接收消息。如果一个成员在5秒内没有收到另一个成员的消息，它会怀疑该成员已经失败，并在其自己的Performance schema的replication_group_members表中将该成员的状态列为UNREACHABLE。通常，两个成员会互相怀疑对方失败了，因为它们都没有与对方通信。也有可能，但不太可能，成员A怀疑成员B失败了，但成员B并不怀疑成员A失败了——可能是由于路由或防火墙问题。一个成员也可以对自己产生怀疑。一个与群组其他成员隔离的成员会怀疑所有其他成员都失败了。

如果怀疑持续超过10秒，怀疑成员尝试将其认为怀疑成员有故障的观点传播给群组的其他成员。一个怀疑成员只有在它是通知者时才会这样做，这是根据其内部XCom节点号计算的。如果一个成员实际上与群组其他成员隔离了，它可能会尝试传播其观点，但这没有后果，因为它无法获得其他成员的多数同意。只有当一个成员是通知者，并且其怀疑持续足够长时间以被传播到群组的其他成员，并且其他成员对此达成一致时，怀疑才会产生后果。在这种情况下，怀疑成员被标记为从群组中驱逐的协调决定，并在由系统变量group_replication_member_expel_timeout设置的等待期过后被驱逐出群组，并且驱逐机制检测并实施了驱逐。

在网络不稳定，成员频繁以不同组合失去并恢复彼此的连接的情况下，理论上可能导致一个群组最终标记所有成员为驱逐对象，之后群组将不复存在，必须重新设置。为了对抗这种可能性，从MySQL 8.0.20开始，群组复制的群组通信系统（GCS）跟踪已被标记为驱逐的群组成员，并在决定是否有多数时将它们视为在被怀疑成员群中。这确保至少有一个成员留在群组中，群组可以继续存在。当被驱逐的成员实际上已从群组中移除时，GCS会移除其标记成员为驱逐的记录，以便成员在能够的情况下重新加入群组。

有关可配置的群组复制系统变量信息，用于指定工作群组成员对故障情况的响应以及被怀疑失败的群组成员采取的行动，请参见第18.7.7节，“对故障检测和网络分区的响应”。