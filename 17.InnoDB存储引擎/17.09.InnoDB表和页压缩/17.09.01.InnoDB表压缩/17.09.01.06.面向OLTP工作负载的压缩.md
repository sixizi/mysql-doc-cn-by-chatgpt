#### 17.9.1.6 面向OLTP工作负载的压缩

传统上，`InnoDB`压缩功能主要推荐用于只读或主要读取的工作负载，例如在数据仓库配置中。SSD存储设备的兴起（它们快速但相对较小且昂贵）也使得压缩对于OLTP工作负载变得有吸引力：高流量、交互式网站可以通过使用压缩表减少它们的存储需求和每秒I/O操作数（IOPS），适用于执行频繁`INSERT`、`UPDATE`和`DELETE`操作的应用。

这些配置选项让您可以调整特定MySQL实例中压缩的工作方式，强调针对写入密集型操作的性能和可扩展性：

- `innodb_compression_level`允许您调整压缩程度。较高的值可以让您将更多数据存储到存储设备上，但代价是压缩过程中更多的CPU开销。较低的值可以在存储空间不是关键因素，或您预计数据不是特别可压缩时，减少CPU开销。

- `innodb_compression_failure_threshold_pct`指定了更新压缩表时压缩失败的临界点。当这个阈值被超过时，MySQL开始在每个新压缩页面内留下额外的空闲空间，动态调整空闲空间的量，直到`innodb_compression_pad_pct_max`指定的页面大小的百分比。

- `innodb_compression_pad_pct_max`允许您调整每个页面内保留的最大空间量，以记录对压缩行的更改，而无需再次压缩整个页面。该值越高，可以在不重新压缩页面的情况下记录的更改越多。MySQL对每个压缩表中的页面使用变量量的空闲空间，仅当指定百分比的压缩操作在运行时“失败”，需要进行昂贵的操作来拆分压缩页面时。

- `innodb_log_compressed_pages`允许您禁止将重新压缩的页面的图像写入重做日志。在对压缩数据进行更改时可能会发生重新压缩。此选项默认启用，以防止在恢复过程中使用不同版本的`zlib`压缩算法时可能发生的损坏。如果您确定`zlib`版本不会改变，禁用`innodb_log_compressed_pages`以减少修改压缩数据的工作负载的重做日志生成。

因为处理压缩数据有时涉及同时在内存中保持页面的压缩和未压缩版本，因此在将压缩与OLTP风格的工作负载一起使用时，准备好增加`innodb_buffer_pool_size`配置选项的值。