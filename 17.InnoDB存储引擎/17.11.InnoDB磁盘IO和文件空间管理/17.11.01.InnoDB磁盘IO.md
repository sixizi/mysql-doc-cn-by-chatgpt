### 17.11.1 InnoDB 磁盘 I/O

InnoDB 尽可能使用异步磁盘 I/O，通过创建多个线程来处理 I/O 操作，同时允许其他数据库操作在 I/O 进行时继续进行。在 Linux 和 Windows 平台上，InnoDB 使用可用的操作系统和库函数执行“原生”异步 I/O。在其他平台上，InnoDB 仍使用 I/O 线程，但这些线程可能实际上会等待 I/O 请求完成；这种技术被称为“模拟”异步 I/O。

#### 预读

如果 InnoDB 能确定某些数据很可能很快就需要，它会执行预读操作，将这些数据带入缓冲池，以便数据在内存中可用。对连续数据进行几次大型读取请求比进行多次小型、分散的请求更有效。InnoDB 有两种预读启发式方法：

- 在顺序预读中，如果 InnoDB 注意到对表空间中某个段的访问模式是顺序的，它会提前向 I/O 系统提交一批数据库页面的读取请求。
- 在随机预读中，如果 InnoDB 注意到表空间中的某个区域似乎正在被完全读入缓冲池，它会将剩余的读取请求提交给 I/O 系统。

有关配置预读启发式的信息，请参见第 17.8.3.4 节，“配置 InnoDB 缓冲池预取（预读）”。

#### 双写缓冲区

InnoDB 使用一种名为双写缓冲区的新颖文件刷新技术，默认情况下在大多数情况下启用（`innodb_doublewrite`=ON）。它在意外退出或电源故障后恢复时增加了安全性，并通过减少对 fsync() 操作的需求，在大多数 Unix 变体上提高了性能。

在将页面写入数据文件之前，InnoDB 首先将它们写入称为双写缓冲区的存储区域。只有在双写缓冲区的写入和刷新完成后，InnoDB 才将页面写入数据文件的适当位置。如果在页面写入过程中发生操作系统、存储子系统或意外的 mysqld 进程退出（导致页面损坏情况），InnoDB 可以在恢复期间从双写缓冲区找到页面的良好副本。

有关双写缓冲区的更多信息，请参见第 17.6.4 节，“双写缓冲区”。