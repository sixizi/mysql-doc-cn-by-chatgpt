### 17.12.7 在线 DDL 失败条件

在线 DDL 操作失败通常是由于以下条件之一造成的：

- ALGORITHM 子句指定了一个与特定类型的 DDL 操作或存储引擎不兼容的算法。
- LOCK 子句指定了一个与特定类型的 DDL 操作不兼容的低锁定级别（SHARED 或 NONE）。
- 在 DDL 操作的初始和最终阶段短暂需要时，等待表上的独占锁超时。
- 当 MySQL 在索引创建期间将临时排序文件写入磁盘时，tmpdir 或 innodb_tmpdir 文件系统耗尽磁盘空间。更多信息，请参见第 17.12.3 节，“在线 DDL 空间需求”。
- 操作耗时很长，并且并发 DML 修改了表，以至于临时在线日志的大小超过了 `innodb_online_alter_log_max_size` 配置选项的值。这种情况会导致 DB_ONLINE_LOG_TOO_BIG 错误。
- 并发 DML 对表进行了更改，这些更改在原始表定义中允许，但在新的定义中不允许。操作只有在最后，当 MySQL 尝试应用所有来自并发 DML 语句的更改时才会失败。例如，当正在创建唯一索引时，你可能会在某列中插入重复值，或者在对该列创建主键索引时插入 NULL 值。并发 DML 所做的更改优先，ALTER TABLE 操作实际上被回滚。